{% load static %}

{% block head %}
    <link rel="stylesheet" href="{% static 'css/dropdown.css' %}">
{% endblock %}


<nav class="w-full flex justify-between items-center py-3 px-4 fixed z-50 bg-neutral-950">
    <div class="w-6/12">
        <a href="{% url 'anime:homepage' %}">
            <img class="w-2/12" src="{% static 'images/animeflix.png' %}">
        </a>
    </div>

    <div class="w-6/12 flex flex-nowrep justify-end">
        {% if user.is_authenticated %}
            <div class="mr-2">
                <form method="get" action="{% url 'anime:pesquisa_anime' %}">
                    <input type="text" class="py-1 px-2 rounded-md text-black" name="query" value="{{ request.GET.query }}" placeholder="Pesquisar...">
                </form>
            </div>

            <div class="dropdown">
                <button onclick="myFunction()" class="inline-flex w-full justify-center gap-x-1.5 rounded-md font-semibold dropbtn bg-violet-700 text-white rounded-md py-1 px-3">
                    {{ request.user.username}}

                    <svg class="-mr-2.5 mt-0.5 h-5 w-5 text-white" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                      <path fill-rule="evenodd" d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z" clip-rule="evenodd"/>
                    </svg>
                </button>

                <div id="myDropdown" class="dropdown-content">
                    {% if request.user.is_superuser %}
                          <a href="{% url 'admin:index' %}" class="inline-flex w-full gap-x-2.5 font-semibold text-white rounded-t-lg bg-neutral-800 hover:bg-neutral-900">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75" />
                              </svg>

                              Editar site
                          </a>

                          <a href="{% url 'anime:editar_perfil' request.user.pk %}" class="inline-flex w-full gap-x-2.5 font-semibold text-white bg-neutral-800 hover:bg-neutral-900">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                              </svg>

                              Editar perfil
                          </a>
                    {% else %}
                        <a href="{% url 'anime:editar_perfil' request.user.pk %}" class="inline-flex w-full gap-x-2.5 font-semibold text-white rounded-t-lg bg-neutral-800 hover:bg-neutral-900">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                              </svg>

                              Editar perfil
                          </a>
                    {% endif %}

                    <a href="{% url 'anime:logout' %}" class="inline-flex w-full gap-x-2 font-semibold text-white rounded-b-lg bg-red-600 hover:bg-red-700">
                      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75" />
                      </svg>

                      Sair
                    </a>
                </div>
            </div>

        {% else %}
            <div class="mr-2">
                <a href="{% url 'anime:login' %}">
                    <button class="bg-violet-700 text-white rounded-md py-1 px-3">
                        Login
                    </button>
                </a>
            </div>
        {% endif %}
    </div>
</nav>

<script>
/* When the user clicks on the button,
toggle between hiding and showing the dropdown content */
function myFunction() {
  document.getElementById("myDropdown").classList.toggle("show");
}

// Close the dropdown if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {
    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>